# 文献综述多智能体系统蓝图

## 项目目标
- **仓库状态**：全新仓库，需要从零搭建。
- **总体使命**：基于 Microsoft AutoGen 0.4 搭建多智能体系统，生成带高质量引用的文献综述。
- **核心理念**：
  1. 以暗猜接口为耻，以认真查阅为荣。
  2. 以模糊执行为耻，以寻求确认为荣。
  3. 以盲想业务为耻，以人类确认为荣。
  4. 以创造接口为耻，以复用现有为荣。
  5. 以跳过验证为耻，以主动测试为荣。
  6. 以破坏架构为耻，以遵循规范为荣。
  7. 以假装理解为耻，以诚实无知为菜。
  8. 以盲目修改为耻，以谨慎重构为荣。

## 指令来源与依赖
- **参考文档**：仓库根目录下的 `MULTI_AGENT_SYSTEM_GUIDE.md`（AutoGen 系统开发指南）。
- **外部依赖**：必须参考官方仓库 [microsoft/autogen](https://github.com/microsoft/autogen)（可通过 Fork 或下载获取）。
- **本地配置**：
  - 在 `.env` 中配置 `V3_API_KEY`（见 `.env.example`）。
  - `.env` 文件需加入 `.gitignore`，禁止提交敏感信息。

## 系统阶段流程
1. **任务输入**：人类提供一个综述主题（Topic）。
2. **协调与大纲智能体**：
   - 协调流程与任务分发。
   - 生成文献综述的全局大纲。
3. **搜索智能体集群**：
   - 接收全局大纲与各自负责的小节标题。
   - 为每个标题生成合适的查询语句（需显式 Prompt 设计）。
   - 访问 arXiv（注意限流策略）检索相关论文。
   - 输出格式：`{ section_title, papers[] }`，其中 `papers` 包含元数据与摘要缓存。
4. **撰写智能体**：
   - 根据对应小节的论文集合撰写段落。
   - 每个论断必须由文献摘要佐证，避免幻觉。
   - 引用格式：`Claim... [arXiv:1706.03762]`。
   - 交付结构化段落和引用元数据（供后续合并与参考文献生成）。
5. **幻觉反馈智能体**：
   - 输入：带引用的段落（按句切割为 Claim）。
   - 核验流程：
     - 若可复用缓存摘要，直接检索；否则重新获取。
     - 判断引用对应的论文元数据及内容是否支撑 Claim。
   - 输出分类：
     1. `SUPPORTED`（元数据正确且摘要支持）。
     2. `UNSUPPORTED`（元数据正确但内容不支撑）。
     3. `INVALID_METADATA`（引用元数据不匹配）。
   - 汇总反馈并返回撰写智能体进行返工。
   - 提供最终评估：各分类数量、准确率、返工前后对比。
6. **结果汇总智能体**：
   - 汇总所有段落。
   - 按引用 ID 顺序生成参考文献列表。
   - 输出完整综述文档。

## 协调机制需求
- 明确的消息协议与任务路由，遵循 AutoGen 设计模式（如 Handoff、Reflection）。
- 支持并发或顺序搜索智能体，兼顾 arXiv 限速要求。
- 反馈循环：撰写 ↔ 幻觉检测 ↔ 返工。
- 可扩展性：支持增加额外工具或新角色。

## 当前任务范围
- 不实现完整代码。
- 交付内容：
  1. AutoGen 方案分析与开发路线图。
  2. arXiv 搜索机制调研与设计建议。
  3. LLM 调用（中转 API）示例与封装策略。
  4. Claude 使用说明与仓库规范文档。

## 约束与注意事项
- 所有文档与代码需遵循 `MULTI_AGENT_SYSTEM_GUIDE.md` 的约束与最佳实践。
- 在实现阶段必须使用 AutoGen 0.4 API，并保持消息结构化。
- 强制缓存 arXiv 摘要，以支持幻觉反馈智能体的复核。
- 对外接口复用现有方案，避免自定义未验证的 API。
- 所有关键决策需要查阅资料并记录依据，禁止主观臆断。
- 开发过程中保持测试驱动与日志透明，防止未验证的逻辑上线。

